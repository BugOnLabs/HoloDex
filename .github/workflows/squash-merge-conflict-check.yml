name: Pull Request Workflow

on:
  pull_request:
    branches:
      - develop # Branche cible de la PR

jobs:
  pr-job:
    runs-on: ubuntu-latest
    steps:
      - name: Display PR Information
        run: |
          echo "ğŸ‰ This workflow was triggered by a pull request!"
          echo "ğŸ” Branch source: ${{ github.head_ref }}"
          echo "ğŸ” Branch target: ${{ github.base_ref }}"
          echo "ğŸ”— PR URL: ${{ github.event.pull_request.html_url }}"

      - name: Check out repository code
        uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }} # Assure de rÃ©cupÃ©rer la branche source

      - name: Fetch target branch
        run: |
          git fetch origin ${{ github.base_ref }} # RÃ©cupÃ¨re la branche cible

      - name: Verify rebasing
        run: |
          # VÃ©rifie si la branche cible est un ancÃªtre de la branche source
          git merge-base --is-ancestor origin/${{ github.base_ref }} HEAD || exit 1

      - name: Success
        if: ${{ success() }}
        run: echo "âœ… Branch source is correctly rebased on branch target!"

      - name: Fail
        if: ${{ failure() }}
        run: echo "âŒ Branch source is NOT rebased on branch target. Please rebase."
