name: PR Rebase Check
on:
 pull_request:
   branches: [develop]

jobs:
 info:
   runs-on: ubuntu-latest
   steps:
     - name: Collect PR Info
       run: |
         echo "ğŸ“Š PR Details"
         echo "â”œâ”€â”€ ğŸ”€ PR #${{ github.event.pull_request.number }}"
         echo "â”œâ”€â”€ ğŸ“ Title: ${{ github.event.pull_request.title }}"
         echo "â”œâ”€â”€ ğŸ‘¤ Author: ${{ github.event.pull_request.user.login }}"
         echo "â”œâ”€â”€ ğŸŒ¿ Source: ${{ github.head_ref }}"
         echo "â””â”€â”€ ğŸ¯ Target: ${{ github.base_ref }}"

 check:
   needs: info
   runs-on: ubuntu-latest
   steps:
     - uses: actions/checkout@v4
       with:
         fetch-depth: 0
         
     - name: Check Rebase Status
       run: |
         git fetch origin
         AHEAD=$(git rev-list --count origin/${{ github.base_ref }}..HEAD)
         BEHIND=$(git rev-list --count HEAD..origin/${{ github.base_ref }})
         
         echo "ğŸ“Š Branch Status"
         echo "â”œâ”€â”€ ğŸ”¼ Commits ahead: $AHEAD"
         echo "â””â”€â”€ ğŸ”½ Commits behind: $BEHIND"
         
         if [ $BEHIND -gt 0 ]; then
           echo "âŒ Rebase Required"
           echo "â””â”€â”€ Missing $BEHIND commits from ${{ github.base_ref }}"
           echo "ğŸ’¡ Run: git pull --rebase origin ${{ github.base_ref }}"
           exit 1
         else
           echo "âœ… Branch up-to-date with ${{ github.base_ref }}"
         fi
